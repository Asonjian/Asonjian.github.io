<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Python-Excel操作学习 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="编辑时间列表    Num Time author Notes    1 2023.2.15 安健 None   Excel基本操作 安装 pip install xlwt&#x2F;xlrd&#x2F;xlutils…..  1.常用操作库 xlrd：从 Excel 中读取数据，支持 xls、xlsx。 xlwt：向 Excel 中写入数据，支持 xls。 xlutils：提供了一些 Excel">
<meta property="og:type" content="article">
<meta property="og:title" content="Python-Excel操作学习">
<meta property="og:url" content="http://example.com/2023/02/15/python%E5%AD%A6%E4%B9%A0/excel%E6%93%8D%E4%BD%9C/excel_study/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="编辑时间列表    Num Time author Notes    1 2023.2.15 安健 None   Excel基本操作 安装 pip install xlwt&#x2F;xlrd&#x2F;xlutils…..  1.常用操作库 xlrd：从 Excel 中读取数据，支持 xls、xlsx。 xlwt：向 Excel 中写入数据，支持 xls。 xlutils：提供了一些 Excel">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-02-15T11:58:10.312Z">
<meta property="article:modified_time" content="2023-02-15T12:06:19.220Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-python学习/excel操作/excel_study" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/02/15/python%E5%AD%A6%E4%B9%A0/excel%E6%93%8D%E4%BD%9C/excel_study/" class="article-date">
  <time class="dt-published" datetime="2023-02-15T11:58:10.312Z" itemprop="datePublished">2023-02-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Python-Excel操作学习
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><em><strong>编辑时间列表</strong></em></p>
<table>
<thead>
<tr>
<th>Num</th>
<th>Time</th>
<th>author</th>
<th>Notes</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>2023.2.15</td>
<td>安健</td>
<td>None</td>
</tr>
</tbody></table>
<h1 id="Excel基本操作"><a href="#Excel基本操作" class="headerlink" title="Excel基本操作"></a>Excel基本操作</h1><blockquote>
<p>安装 <em><strong>pip install xlwt&#x2F;xlrd&#x2F;xlutils…..</strong></em></p>
</blockquote>
<h2 id="1-常用操作库"><a href="#1-常用操作库" class="headerlink" title="1.常用操作库"></a>1.常用操作库</h2><ol>
<li>xlrd：从 Excel 中读取数据，支持 xls、xlsx。</li>
<li>xlwt：向 Excel 中写入数据，支持 xls。</li>
<li>xlutils：提供了一些 Excel 的实用操作，比如复制、拆分、过滤等，通常与 4. xlrd、xlwt 一起使用。</li>
<li>XlsxWriter：向 Excel 中写入数据，支持 xlsx。</li>
<li>openpyxl ：用于读写 Excel，支持 xlsx。</li>
</ol>
<h2 id="2-写入"><a href="#2-写入" class="headerlink" title="2.写入"></a>2.写入</h2><h3 id="2-1使用-xlwt"><a href="#2-1使用-xlwt" class="headerlink" title="2.1使用 xlwt"></a>2.1使用 xlwt</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建工作簿</span></span><br><span class="line">wb = xlwt.Workbook()</span><br><span class="line"><span class="comment"># 创建表单</span></span><br><span class="line">sh = wb.add_sheet(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建字体对象</span></span><br><span class="line">font = xlwt.Font()</span><br><span class="line"><span class="comment"># 字体加粗</span></span><br><span class="line">font.bold = <span class="literal">True</span></span><br><span class="line">alm = xlwt.Alignment()</span><br><span class="line"><span class="comment"># 设置左对齐</span></span><br><span class="line">alm.horz = <span class="number">0x01</span></span><br><span class="line"><span class="comment"># 创建样式对象</span></span><br><span class="line">style1 = xlwt.XFStyle()</span><br><span class="line">style2 = xlwt.XFStyle()</span><br><span class="line">style1.font = font</span><br><span class="line">style2.alignment = alm</span><br><span class="line"><span class="comment"># write 方法参数1：行，参数2：列，参数3：内容</span></span><br><span class="line">sh.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;姓名&#x27;</span>, style1)</span><br><span class="line">sh.write(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&#x27;年龄&#x27;</span>, style1)</span><br><span class="line">sh.write(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">1</span>, <span class="number">2</span>, <span class="number">50</span>, style2)</span><br><span class="line">sh.write(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&#x27;李四&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">2</span>, <span class="number">2</span>, <span class="number">30</span>, style2)</span><br><span class="line">sh.write(<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;王五&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">3</span>, <span class="number">2</span>, <span class="number">40</span>, style2)</span><br><span class="line">sh.write(<span class="number">4</span>, <span class="number">1</span>, <span class="string">&#x27;赵六&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">4</span>, <span class="number">2</span>, <span class="number">60</span>, style2)</span><br><span class="line">sh.write(<span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;平均年龄&#x27;</span>, style1)</span><br><span class="line"><span class="comment"># 保存</span></span><br><span class="line">wb.save(<span class="string">&#x27;test.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="2-2-使用XlsxWriter"><a href="#2-2-使用XlsxWriter" class="headerlink" title="2.2 使用XlsxWriter"></a>2.2 使用XlsxWriter</h3> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> xlwt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建工作簿</span></span><br><span class="line">wb = xlwt.Workbook()</span><br><span class="line"><span class="comment"># 创建表单</span></span><br><span class="line">sh = wb.add_sheet(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建字体对象</span></span><br><span class="line">font = xlwt.Font()</span><br><span class="line"><span class="comment"># 字体加粗</span></span><br><span class="line">font.bold = <span class="literal">True</span></span><br><span class="line">alm = xlwt.Alignment()</span><br><span class="line"><span class="comment"># 设置左对齐</span></span><br><span class="line">alm.horz = <span class="number">0x01</span></span><br><span class="line"><span class="comment"># 创建样式对象</span></span><br><span class="line">style1 = xlwt.XFStyle()</span><br><span class="line">style2 = xlwt.XFStyle()</span><br><span class="line">style1.font = font</span><br><span class="line">style2.alignment = alm</span><br><span class="line"><span class="comment"># write 方法参数1：行，参数2：列，参数3：内容</span></span><br><span class="line">sh.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;姓名&#x27;</span>, style1)</span><br><span class="line">sh.write(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&#x27;年龄&#x27;</span>, style1)</span><br><span class="line">sh.write(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">1</span>, <span class="number">2</span>, <span class="number">50</span>, style2)</span><br><span class="line">sh.write(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&#x27;李四&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">2</span>, <span class="number">2</span>, <span class="number">30</span>, style2)</span><br><span class="line">sh.write(<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;王五&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">3</span>, <span class="number">2</span>, <span class="number">40</span>, style2)</span><br><span class="line">sh.write(<span class="number">4</span>, <span class="number">1</span>, <span class="string">&#x27;赵六&#x27;</span>)</span><br><span class="line">sh.write(<span class="number">4</span>, <span class="number">2</span>, <span class="number">60</span>, style2)</span><br><span class="line">sh.write(<span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;平均年龄&#x27;</span>, style1)</span><br><span class="line"><span class="comment"># 保存</span></span><br><span class="line">wb.save(<span class="string">&#x27;test.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>XlsxWriter 可以很方便的生成图表。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建工作簿</span></span><br><span class="line">wk = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建表单</span></span><br><span class="line">sh = wk.add_worksheet(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">fmt1 = wk.add_format()</span><br><span class="line">fmt2 = wk.add_format()</span><br><span class="line"><span class="comment"># 字体加粗</span></span><br><span class="line">fmt1.set_bold(<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 设置左对齐</span></span><br><span class="line">fmt2.set_align(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"><span class="comment"># 数据</span></span><br><span class="line">data = [</span><br><span class="line">    [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;年龄&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">50</span>],</span><br><span class="line">    [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="number">30</span>],</span><br><span class="line">    [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">40</span>],</span><br><span class="line">    [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;赵六&#x27;</span>, <span class="number">60</span>],</span><br><span class="line">    [<span class="string">&#x27;平均年龄&#x27;</span>, <span class="string">&#x27;&#x27;</span>, ]</span><br><span class="line">]</span><br><span class="line">sh.write_row(<span class="string">&#x27;A1&#x27;</span>, data[<span class="number">0</span>], fmt1)</span><br><span class="line">sh.write_row(<span class="string">&#x27;A2&#x27;</span>, data[<span class="number">1</span>], fmt2)</span><br><span class="line">sh.write_row(<span class="string">&#x27;A3&#x27;</span>, data[<span class="number">2</span>], fmt2)</span><br><span class="line">sh.write_row(<span class="string">&#x27;A4&#x27;</span>, data[<span class="number">3</span>], fmt2)</span><br><span class="line">sh.write_row(<span class="string">&#x27;A5&#x27;</span>, data[<span class="number">4</span>], fmt2)</span><br><span class="line">sh.write_row(<span class="string">&#x27;A6&#x27;</span>, data[<span class="number">5</span>], fmt1)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">area：面积图</span></span><br><span class="line"><span class="string">bar：直方图</span></span><br><span class="line"><span class="string">column：柱状图</span></span><br><span class="line"><span class="string">line：折线图</span></span><br><span class="line"><span class="string">pie：饼图</span></span><br><span class="line"><span class="string">doughnut：环形图</span></span><br><span class="line"><span class="string">radar：雷达图</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">chart = wk.add_chart(&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;line&#x27;</span>&#125;)</span><br><span class="line"><span class="comment"># 创建图表</span></span><br><span class="line">chart.add_series(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;=test!$B$1&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;categories&#x27;</span>:<span class="string">&#x27;=test!$B$2:$B$5&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;values&#x27;</span>:   <span class="string">&#x27;=test!$C$2:$C$5&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">chart.set_title(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;用户年龄折线图&#x27;</span>&#125;)</span><br><span class="line">chart.set_x_axis(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;姓名&#x27;</span>&#125;)</span><br><span class="line">chart.set_y_axis(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;年龄&#x27;</span>&#125;)</span><br><span class="line">sh.insert_chart(<span class="string">&#x27;A9&#x27;</span>, chart)</span><br><span class="line">wk.close()</span><br></pre></td></tr></table></figure>
<h2 id="3-读取"><a href="#3-读取" class="headerlink" title="3.读取"></a>3.读取</h2> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> xlrd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开</span></span><br><span class="line">wb = xlrd.open_workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&#x27;sheet名称:&#x27;</span>, wb.sheet_names())</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&#x27;sheet数量:&#x27;</span>, wb.nsheets)</span><br><span class="line"><span class="comment"># 根据 sheet 索引获取 sheet</span></span><br><span class="line">sh = wb.sheet_by_index(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 根据 sheet 名称获取 sheet</span></span><br><span class="line"><span class="comment"># sh = wb.sheet_by_name(&#x27;test&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>( <span class="string">u&#x27;sheet %s 有 %d 行&#x27;</span> % (sh.name, sh.nrows))</span><br><span class="line"><span class="built_in">print</span>( <span class="string">u&#x27;sheet %s 有 %d 列&#x27;</span> % (sh.name, sh.ncols))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第二行内容:&#x27;</span>, sh.row_values(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第三列内容:&#x27;</span>, sh.col_values(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第二行第三列的值为:&#x27;</span>, sh.cell_value(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第二行第三列值的类型为:&#x27;</span>, <span class="built_in">type</span>(sh.cell_value(<span class="number">1</span>, <span class="number">2</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="4-修改"><a href="#4-修改" class="headerlink" title="4.修改"></a>4.修改</h2><p>之前写入的数据还有一个平均年龄是空着的，我们先读取之前写入的数据，再计算出平均值，最后将平均值写入。这里要用到 xlutils 模块，使用 pip install xlutils 安装。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlrd, xlwt</span><br><span class="line"><span class="keyword">from</span> xlutils.copy <span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">avg</span>(<span class="params"><span class="built_in">list</span></span>):</span><br><span class="line">    sumv = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">        sumv += <span class="built_in">list</span>[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(sumv / <span class="built_in">len</span>(<span class="built_in">list</span>))</span><br><span class="line"><span class="comment"># formatting_info 为 True 表示保留原格式</span></span><br><span class="line">wb = xlrd.open_workbook(<span class="string">&#x27;test.xls&#x27;</span>, formatting_info=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 复制</span></span><br><span class="line">wbc = copy(wb)</span><br><span class="line">sh = wb.sheet_by_index(<span class="number">0</span>)</span><br><span class="line">age_list = sh.col_values(<span class="number">2</span>)</span><br><span class="line">age_list = age_list[<span class="number">1</span>:<span class="built_in">len</span>(age_list)-<span class="number">1</span>]</span><br><span class="line">avg_age = avg(age_list)</span><br><span class="line">sh = wbc.get_sheet(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 设置左对齐</span></span><br><span class="line">alm = xlwt.Alignment()</span><br><span class="line">alm.horz = <span class="number">0x01</span></span><br><span class="line">style = xlwt.XFStyle()</span><br><span class="line">style.alignment = alm</span><br><span class="line">sh.write(<span class="number">5</span>, <span class="number">2</span>, avg_age, style)</span><br><span class="line">wbc.save(<span class="string">&#x27;test.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/02/15/python%E5%AD%A6%E4%B9%A0/excel%E6%93%8D%E4%BD%9C/excel_study/" data-id="cle9xt6270000acvi7ltugdqu" data-title="Python-Excel操作学习" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/02/18/Matlab_study/Smulink%E5%BB%BA%E6%A8%A1%E4%B8%8E%E4%BB%BF%E7%9C%9F/Simulink/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Simulink仿真与建模学习
        
      </div>
    </a>
  
  
    <a href="/2023/02/15/python%E5%AD%A6%E4%B9%A0/word%E6%93%8D%E4%BD%9C/word/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Python-Word操作学习</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/02/20/linux%E5%AD%A6%E4%B9%A0/%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA/">Linux系统分区</a>
          </li>
        
          <li>
            <a href="/2023/02/18/Matlab_study/Smulink%E5%BB%BA%E6%A8%A1%E4%B8%8E%E4%BB%BF%E7%9C%9F/Simulink/">Simulink仿真与建模学习</a>
          </li>
        
          <li>
            <a href="/2023/02/15/python%E5%AD%A6%E4%B9%A0/excel%E6%93%8D%E4%BD%9C/excel_study/">Python-Excel操作学习</a>
          </li>
        
          <li>
            <a href="/2023/02/15/python%E5%AD%A6%E4%B9%A0/word%E6%93%8D%E4%BD%9C/word/">Python-Word操作学习</a>
          </li>
        
          <li>
            <a href="/2023/02/15/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/%E5%9B%BE%E5%83%8F%E5%8A%A0%E6%96%87%E6%9C%AC(python%E5%AE%9E%E7%8E%B0)/Add_Str_to%20Img/">图片添加文本</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>